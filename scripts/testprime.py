from Cryptodome.Math.Primality import test_probable_prime, PROBABLY_PRIME

if __name__ == '__main__':

    def test_is_prime(self):
        primes = (170141183460469231731687303715884105727,
                  19175002942688032928599,
                  1363005552434666078217421284621279933627102780881053358473,
                  2 ** 521 - 1)
        for p in primes:
            self.assertEqual(test_probable_prime(p), PROBABLY_PRIME)

        not_primes = (
            4754868377601046732119933839981363081972014948522510826417784001,
            1334733877147062382486934807105197899496002201113849920496510541601,
            260849323075371835669784094383812120359260783810157225730623388382401,
        )
        for np in not_primes:
            print("Testing: " + str(np))
            self.assertEqual(test_probable_prime(np), COMPOSITE)


test_probable_prime(154743920677524552878070707053653332164299660841830017929219293685667568749444998811975815665714544229961357864264853363027916649474815493349075187664296498790933188677300801346467014816215858961315576749068407287703797236061946292920294032557578225336038654226866190187355275296415885620268049747332071961711)
